# CustopmVisionでExportしたモデルをTensorflowLite用に変換するサンプル

変換処理本体 ＆ 変換モデルデータ格納
変換したモデルはCPUで実行するモデルだが、コンパイルすればEdge-TPUでも使用できる。  
変換処理後、変換したtfliteファイルを``edgetpu_compiler``でコンパイルして Edge-TPU 用ファイルを出力する。    
Edge-TPU用モデルは ファイル名本体末尾に``_edgetpu``付加されたファイル。

## ディレクトリ構成

| ディレクトリ          | 内容                                              |
|-----------------------|---------------------------------------------------|
| run.sh                | 変換処理実行スクリプト                            |  
| saved_model2tflite.py | 変換処理本体                                      |
| data                  | 整数量子化キャリブレーション用入力ファイル 格納用ディレクトリ   |

### 整数量子化キャリブレーション用入力ファイル
整数量子化処理を行った場合、誤差を低減するため、キャリブレーションを行う。  
そのための画像ファイルを用意する。画像ファイルは何でも良いが、CustomVisionで学習に使用したファイルをdetaディレクトリに格納しておけば良いと思う。  
学習処理とは異なり、実行時間はそんなにかからない。    

## 変換処理プログラム実行方法

run.shの以下のパラメータを変更して、run.shを実行する

| 変数           | 内容                                              |
|----------------|---------------------------------------------------|
| SAVED_DIR      | CustomVisionでエクスポートしたSavedModelを格納したディレクトリ |
| OUTPUT_FILE    | 出力ファイル                                          |


**Tensorflow 1.15**が使用できるpythonの実行環境で実行すること。

